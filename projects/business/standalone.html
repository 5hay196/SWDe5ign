<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Business Web Platform with ISMS Integration and AI Bot Services">
    <title>Business Web Platform | ISMS & AI Solutions</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
        }

        /* Header and Navigation */
        .navbar {
            background: #2c3e50;
            color: white;
            padding: 1rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
        }

        .nav-brand h1 {
            font-size: 1.5rem;
            color: #3498db;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-menu a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }

        .nav-menu a:hover {
            color: #3498db;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 4rem 2rem;
            min-height: 60vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hero-content h2 {
            font-size: 3rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        .cta-button {
            background: #e74c3c;
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 5px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.3s;
        }

        .cta-button:hover {
            background: #c0392b;
        }

        /* Services Section */
        .services {
            max-width: 1200px;
            margin: 4rem auto;
            padding: 0 2rem;
            text-align: center;
        }

        .services h2 {
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #2c3e50;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .service-card {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .service-card:hover {
            transform: translateY(-5px);
        }

        .service-card h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        /* AI Bot Section */
        .ai-bot-section {
            background: #ecf0f1;
            padding: 4rem 2rem;
            text-align: center;
        }

        .ai-bot-section h2 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 2rem;
        }

        #bot-interface {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-height: 400px;
        }

        /* Bot Interface Styles */
        .bot-chat-container {
            max-width: 100%;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .bot-header {
            background: #2c3e50;
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .bot-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .bot-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #e74c3c;
            animation: pulse 2s infinite;
        }
        
        .status-indicator.online {
            background: #27ae60;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .bot-messages {
            height: 300px;
            overflow-y: auto;
            padding: 1rem;
            background: #f8f9fa;
        }
        
        .bot-message {
            margin-bottom: 1rem;
            max-width: 85%;
        }
        
        .bot-message.user {
            margin-left: auto;
        }
        
        .bot-message.user .message-content {
            background: #3498db;
            color: white;
            text-align: right;
        }
        
        .bot-message.system .message-content,
        .bot-message.assistant .message-content {
            background: white;
            border: 1px solid #e1e8ed;
        }
        
        .message-content {
            padding: 0.75rem 1rem;
            border-radius: 12px;
            word-wrap: break-word;
            line-height: 1.4;
        }
        
        .bot-input-area {
            padding: 1rem;
            border-top: 1px solid #e1e8ed;
            background: white;
        }
        
        .input-container {
            display: flex;
            gap: 0.5rem;
            align-items: flex-end;
        }
        
        #bot-input {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            resize: none;
            font-family: inherit;
            font-size: 0.9rem;
            transition: border-color 0.3s;
        }
        
        #bot-input:focus {
            outline: none;
            border-color: #3498db;
        }
        
        #bot-send {
            padding: 0.75rem;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        #bot-send:hover:not(:disabled) {
            background: #2980b9;
        }

        /* Footer */
        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 2rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-menu {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .hero-content h2 {
                font-size: 2rem;
            }
            
            .service-grid {
                grid-template-columns: 1fr;
            }
        }

        .status-message {
            text-align: center;
            padding: 2rem;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-brand">
                <h1>Business Platform</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="#home">Home</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#isms">ISMS</a></li>
                <li><a href="#ai-bot">AI Assistant</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="home" class="hero">
            <div class="hero-content">
                <h2>Integrated Business Solutions</h2>
                <p>Web Platform ‚Ä¢ ISMS Compliance ‚Ä¢ AI-Powered Automation</p>
                <button class="cta-button" onclick="scrollToBot()">Get Started</button>
            </div>
        </section>

        <section id="services" class="services">
            <h2>Our Services</h2>
            <div class="service-grid">
                <div class="service-card">
                    <h3>üåê Web Development</h3>
                    <p>Modern, responsive web solutions with integrated AI capabilities</p>
                </div>
                <div class="service-card">
                    <h3>üîí ISMS & ISO 27001</h3>
                    <p>Information Security Management Systems implementation and compliance</p>
                </div>
                <div class="service-card">
                    <h3>ü§ñ AI Business Bot</h3>
                    <p>Intelligent automation and business process support with security awareness</p>
                </div>
            </div>
        </section>

        <section id="ai-bot" class="ai-bot-section">
            <h2>AI Business Assistant</h2>
            <div id="bot-interface">
                <div class="bot-chat-container">
                    <div class="bot-header">
                        <h3>Business AI Assistant</h3>
                        <div class="bot-status">
                            <span class="status-indicator" id="status-indicator"></span>
                            <span class="status-text" id="status-text">Connecting...</span>
                        </div>
                    </div>
                    
                    <div class="bot-messages" id="bot-messages">
                        <div class="status-message" id="connection-status">
                            üîÑ Connecting to AI assistant...
                        </div>
                    </div>
                    
                    <div class="bot-input-area">
                        <div class="input-container">
                            <textarea 
                                id="bot-input" 
                                placeholder="Ask me about ISO 27001, risk assessment, or business processes..."
                                rows="2"
                                disabled
                            ></textarea>
                            <button id="bot-send" type="button" disabled>Send</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Business Platform. All rights reserved. | Powered by AI & ISMS Compliance</p>
    </footer>

    <script>
        // Bot Interface JavaScript
        class SimpleBusinessBotInterface {
            constructor() {
                this.apiUrl = 'http://localhost:8002';
                this.wsUrl = 'ws://localhost:8002';
                this.userId = 'user_' + Math.random().toString(36).substr(2, 9);
                this.sessionId = null;
                this.isConnected = false;
                this.websocket = null;
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.testConnection();
            }
            
            setupEventListeners() {
                const sendBtn = document.getElementById('bot-send');
                const input = document.getElementById('bot-input');
                
                sendBtn.addEventListener('click', () => this.sendMessage());
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
            }
            
            async testConnection() {
                try {
                    const response = await fetch(this.apiUrl + '/health');
                    if (response.ok) {
                        const data = await response.json();
                        this.updateStatus('online', `Connected (${data.version})`);
                        this.enableInput();
                        this.showWelcomeMessage();
                        this.connectWebSocket();
                    } else {
                        throw new Error('Bot not responding');
                    }
                } catch (error) {
                    this.updateStatus('offline', 'Bot offline - Start with: python src/bot/simple_bot.py --port 8002');
                    this.showConnectionError();
                }
            }
            
            connectWebSocket() {
                try {
                    this.websocket = new WebSocket(this.wsUrl + '/ws/' + this.userId);
                    
                    this.websocket.onopen = () => {
                        console.log('WebSocket connected');
                    };
                    
                    this.websocket.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.addMessage('assistant', data.response, {
                            domain: data.domain,
                            compliance_risk: data.compliance_risk
                        });
                    };
                    
                    this.websocket.onclose = () => {
                        console.log('WebSocket disconnected');
                    };
                    
                } catch (error) {
                    console.log('WebSocket not available, using HTTP API');
                }
            }
            
            updateStatus(status, text) {
                const indicator = document.getElementById('status-indicator');
                const statusText = document.getElementById('status-text');
                
                indicator.className = `status-indicator ${status}`;
                statusText.textContent = text;
            }
            
            enableInput() {
                document.getElementById('bot-input').disabled = false;
                document.getElementById('bot-send').disabled = false;
            }
            
            showWelcomeMessage() {
                document.getElementById('connection-status').innerHTML = `
                    <div class="bot-message system">
                        <div class="message-content">
                            üëã Hello! I'm your AI business assistant specialized in ISMS, ISO 27001, and security compliance. 
                            <br><br>
                            I can help you with:
                            <br>‚Ä¢ Information security management
                            <br>‚Ä¢ Risk assessment and management  
                            <br>‚Ä¢ ISO 27001 implementation
                            <br>‚Ä¢ Security controls and policies
                            <br>‚Ä¢ Business continuity planning
                            <br><br>
                            What would you like to discuss today?
                        </div>
                    </div>
                `;
            }
            
            showConnectionError() {
                document.getElementById('connection-status').innerHTML = `
                    <div class="bot-message system">
                        <div class="message-content">
                            ‚ùå Unable to connect to the AI assistant.
                            <br><br>
                            To start the bot, run:
                            <br><code>cd business-bot && python src/bot/simple_bot.py --port 8002</code>
                            <br><br>
                            Then refresh this page.
                        </div>
                    </div>
                `;
            }
            
            async sendMessage() {
                const input = document.getElementById('bot-input');
                const message = input.value.trim();
                
                if (!message) return;
                
                // Add user message
                this.addMessage('user', message);
                input.value = '';
                
                try {
                    if (this.websocket && this.websocket.readyState === WebSocket.OPEN) {
                        // Use WebSocket
                        this.websocket.send(JSON.stringify({
                            message: message,
                            context: { timestamp: new Date().toISOString() }
                        }));
                    } else {
                        // Use HTTP API
                        const response = await fetch(this.apiUrl + '/chat', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                message: message,
                                user_id: this.userId,
                                session_id: this.sessionId
                            })
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            this.sessionId = data.session_id;
                            this.addMessage('assistant', data.response, {
                                domain: data.domain,
                                compliance_risk: data.compliance_risk
                            });
                        } else {
                            throw new Error('Failed to get response');
                        }
                    }
                } catch (error) {
                    this.addMessage('system', 'Sorry, I encountered an error. Please check if the bot service is running.');
                }
            }
            
            addMessage(role, content, metadata = {}) {
                const messagesContainer = document.getElementById('bot-messages');
                
                // Clear connection status if it's still there
                const statusMsg = document.getElementById('connection-status');
                if (statusMsg && statusMsg.classList.contains('status-message')) {
                    statusMsg.remove();
                }
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `bot-message ${role}`;
                
                const contentDiv = document.createElement('div');
                contentDiv.className = 'message-content';
                contentDiv.innerHTML = content.replace(/\\n/g, '<br>');
                
                messageDiv.appendChild(contentDiv);
                
                // Add metadata for assistant messages
                if (role === 'assistant' && metadata.domain) {
                    const metaDiv = document.createElement('div');
                    metaDiv.style.fontSize = '0.75rem';
                    metaDiv.style.marginTop = '0.5rem';
                    metaDiv.style.opacity = '0.7';
                    metaDiv.innerHTML = `
                        <span style="background: #ecf0f1; padding: 0.2rem 0.5rem; border-radius: 4px; margin-right: 0.5rem;">
                            ${metadata.domain}
                        </span>
                        <span style="background: ${this.getRiskColor(metadata.compliance_risk)}; color: white; padding: 0.2rem 0.5rem; border-radius: 4px;">
                            ${metadata.compliance_risk || 'low'} risk
                        </span>
                    `;
                    messageDiv.appendChild(metaDiv);
                }
                
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            getRiskColor(risk) {
                const colors = {
                    'low': '#27ae60',
                    'medium': '#f39c12', 
                    'high': '#e74c3c',
                    'critical': '#c0392b'
                };
                return colors[risk] || '#27ae60';
            }
        }
        
        // Navigation functions
        function scrollToBot() {
            document.getElementById('ai-bot').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Smooth scrolling for navigation links
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize bot interface
            new SimpleBusinessBotInterface();
            
            // Setup navigation
            const navLinks = document.querySelectorAll('.nav-menu a');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });
        });
    </script>
</body>
</html>